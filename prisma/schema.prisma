generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  year      Int?
  roles     String[]
  major     String
  minor     String?
  birthday  String
  locale    String
  quote     String
  favThings String[]
  funFact   String
  tradition String
  img       String?

  username String @unique
  password String
  salt     String

  clubs      ClubMembership[]
  posts      Post[]           @relation("PostAuthor")
  likedPosts Post[]           @relation("PostLikes")
}

model Club {
  id          Int              @id @default(autoincrement())
  name        String
  description String
  img         String?
  members     ClubMembership[]
  posts       Post[]
}

model ClubMembership {
  user     User     @relation(fields: [userId], references: [id])
  userId   Int
  club     Club     @relation(fields: [clubId], references: [id])
  clubId   Int
  joinedAt DateTime @default(now()) // use to show "member for x years"

  @@id([userId, clubId])
}

model Post {
  id     Int      @id @default(autoincrement())
  author User     @relation("PostAuthor", fields: [userId], references: [id])
  userId Int
  club   Club     @relation(fields: [clubId], references: [id])
  clubId Int
  text   String
  date   DateTime

  likedBy User[] @relation("PostLikes")
}
